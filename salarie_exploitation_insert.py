import sqlite3

# Nom de la base de données
sqlite_DB = 'agriculture_db.sqlite'

# Connexion à la base de données
conn = sqlite3.connect(sqlite_DB)
c = conn.cursor()

# Nom de la table
table4 = 'salaries'

# Récupérer tous les IDs des enregistrements dans `travaux_agricoles`
c.execute(f"SELECT rowid FROM {table4}")
rows = c.fetchall()

# Vérification des résultats
if not rows:
    print("Aucun enregistrement trouvé dans la table travaux_agricoles.")
else:
    print(f"{len(rows)} enregistrements trouvés dans la table travaux_agricoles.")
    
    # Mise à jour des enregistrements avec des `salarie_id` cycliques de 1 à 21
    for index, row in enumerate(rows):
        salarie_id = (index % 21) + 1  # Génère un `id_salarie` entre 1 et 21
        row_id = row[0]
        c.execute(f"UPDATE {table4} SET prenom_salarie = '' ",)

    # Validation des modifications
    conn.commit()
    print("Mise à jour des salarie_id terminée avec succès.")

# Fermeture de la connexion
conn.close()
